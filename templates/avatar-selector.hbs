<div class="avatar-selector-container">
    {{!-- 頂部工具列 --}}
    <header class="controls">
        <button type="button" data-action="addAvatar" class="add-btn">
            <i class="fas fa-plus"></i> {{localize "YCIO.Avatar.Add"}}
        </button>
        <div class="info">
            {{localize "YCIO.Avatar.Managing"}} <strong>{{targetName}}</strong>
        </div>
    </header>

    {{!-- 頭像列表 --}}
    <div class="avatar-grid">
        {{!-- 1. 預設頭像 --}}
        <div class="avatar-card {{#if (eq currentAvatar '')}}selected{{/if}}" 
             data-action="selectAvatar" data-src="">
            
            <div class="image-wrapper">
                <img src="{{defaultAvatar}}" />
            </div>
            
            <div class="details">
                {{!-- 預設頭像沒有輸入框，顯示標籤即可 --}}
                <span class="system-label">{{localize "YCIO.Avatar.Default"}}</span>
            </div>
        </div>

        {{!-- 2. 自定義頭像列表 --}}
        {{#each avatars}}
            <div class="avatar-card draggable-item {{#if (eq ../currentAvatar this.src)}}selected{{/if}}" 
                 draggable="true"
                 data-action="selectAvatar" 
                 data-src="{{this.src}}"
                 data-index="{{@index}}">
                
                <div class="image-wrapper">
                    <img src="{{this.src}}" draggable="false" />
                    
                    {{!-- 刪除按鈕 (改用 index) --}}
                    <button type="button" class="delete-btn" data-action="deleteAvatar" data-index="{{@index}}">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="details">
                    {{!-- 註解輸入框 --}}
                    <input type="text" class="avatar-label-input" 
                           value="{{this.label}}" 
                           placeholder="{{localize 'YCIO.Avatar.LabelPlaceholder'}}"
                           data-action="updateLabel" data-index="{{@index}}">
                </div>
            </div>
        {{/each}}
    </div>

    {{!-- 底部確認按鈕 --}}
    <footer class="footer">
        <button type="button" data-action="confirm" class="confirm-btn">
            <i class="fas fa-check"></i> {{localize "YCIO.Avatar.Confirm"}}
        </button>
    </footer>
</div>